/* ====== BASE ====== */
* { box-sizing: border-box; }

:root{
  --bg: #000000;          /* nero profondo per il body */
  --main-bg: #0d0d0d;     /* nero leggermente pi첫 chiaro per il contenuto */
  --panel: #111111;
  --panel-2:#121212;
  --stroke:#1f1f1f;
  --text:#e9e9e9;
  --muted:#a9a9a9;
  --accent:#F5D142;       /* giallo opaco */
  --accent-2:#d4b535;     /* giallo pi첫 scuro per hover */
}

html, body {
  height: 100%;
  margin: 0;
  background-color: var(--bg);   /* tutto nero */
  color: var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  display: flex;
  overflow: hidden;
}

/* ====== MAIN ====== */
.main {
  flex: 1;
  display: grid;
  grid-template-rows: 1fr auto;
  height: 100%;
  min-width: 0;
  padding: 26px;
  gap: 12px;
  background-color: var(--main-bg);  /* sfondo scuro per l'area centrale */
  overflow-y: auto;
}
.main.track-page {
  display: block;
  padding: 40px;
}


/* ====== SIDEBAR ====== */
.sb{
  width: 280px;
  background: var(--panel-2);
  border-right: 1px solid var(--stroke);
  height: 100%;
  display: grid;
  grid-template-rows: auto 1fr auto;
  padding: 14px;
  gap: 10px;
}
.sb-header{ display:flex; align-items:center; gap:10px; }
.logo{ width:70px; height:70px; object-fit:contain; border-radius:50%; }
.brand{ font-weight:700; letter-spacing:.3px; }

.sb-nav{ overflow-y:auto; padding-right:6px; margin-top:6px; }
.sb-btn{
  width:100%; background:#181818; border:1px solid var(--stroke); color:var(--text);
  text-align:left; padding:12px 14px; border-radius:10px; margin-bottom:8px;
  cursor:pointer; transition:.18s ease; display:flex; align-items:center; gap:12px;
  text-decoration:none;
}
.sb-btn:hover{ border-color:#2a2a2a; background:var(--accent); }
.sb-btn:hover .btn-text{ color:#000000; }
.sb-btn.active{ background:var(--accent); border-color:var(--accent); }
.sb-btn.active .btn-text{ color:#000000; }
.sb-btn .btn-icon{ font-size:24px; line-height:1; }
.sb-btn .btn-icon-img{ width:28px; height:28px; object-fit:contain; }
.sb-btn .btn-text{ font-weight:600; font-size:15px; }

.sb-footer{ border-top:1px solid var(--stroke); padding-top:10px; color:var(--muted); text-align:center; font-size:12px; }

/* ====== MAIN ====== */
.main{
  flex:1; display:grid; grid-template-rows:1fr auto; height:100%;
  min-width:0; padding:26px; gap:12px;
}
/* Overlay mobile */
.overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.5); opacity:0; pointer-events:none;
  transition:.2s; z-index:9;
}

/* Chat */
.chat-log{
  background: var(--panel);
  border: 1px solid var(--stroke);
  border-radius: 14px;
  padding: 14px;
  overflow-y: auto;
}

.msg{ display:flex; gap:12px; margin-bottom:12px; align-items:flex-start; }
.bubble{
  max-width: 900px; background:#171717; border:1px solid var(--stroke);
  color:var(--text); border-radius:12px; padding:10px 12px; white-space:pre-wrap;
}
.msg.user{ justify-content:flex-end; }
.msg.user .bubble{ background:var(--accent); color:#000000; border-color:var(--accent-2); font-weight:600; }
.role{ font-size:12px; color:var(--muted); min-width:72px; padding-top:3px; }
.msg.user .role{ display:none; }

.typing .bubble{ display:inline-flex; gap:6px; }
.dot{ width:6px; height:6px; border-radius:50%; background:#bdbdbd; opacity:.4; animation:blink 1.2s infinite ease-in-out; }
.dot:nth-child(2){ animation-delay:.2s; } .dot:nth-child(3){ animation-delay:.4s; }
@keyframes blink{ 0%,80%,100%{opacity:.2; transform:translateY(0);} 40%{opacity:1; transform:translateY(-2px);} }

/* Composer */
.composer{
  display:flex; gap:10px; align-items:center; background:var(--panel);
  border:1px solid var(--stroke); border-radius:14px; padding:10px;
}
.composer textarea{
  flex:1; background:transparent; border:none; color:var(--text);
  resize:none; outline:none; font-size:16px; line-height:1.35; max-height:180px;
}
.send{ background:var(--accent); color:#000000; border:none; border-radius:10px; padding:10px 16px; font-weight:800; cursor:pointer; transition:.2s; }
.send:hover{ background:var(--accent-2); color:#000000; }

/* === Quote form box (inline nella chat) === */
.quote-form{
  background:#141414; border:1px dashed #2a2a2a; border-radius:12px; padding:12px; margin-top:6px;
}
.quote-form .row{ display:flex; gap:10px; margin-bottom:8px; }
.quote-form input, .quote-form select{
  background:#0f0f0f; color:#e9e9e9; border:1px solid #2a2a2a; border-radius:8px; padding:8px; flex:1;
}
.quote-form button{
  background:var(--accent); color:#000000; border:none; border-radius:8px; padding:8px 14px; font-weight:700; cursor:pointer; transition:.2s;
}
.quote-form button:hover{ background:var(--accent-2); color:#000000; }

/* === Zone selection buttons === */
.zone-select-btn{
  width:100%; background:#0a0a0a; border:1px solid #2a2a2a; color:#ffffff;
  text-align:left; padding:14px 16px; border-radius:10px; margin-bottom:10px;
  cursor:pointer; transition:.25s ease; display:flex; align-items:center; gap:14px;
}
.zone-select-btn:hover{
  background:#ffffff;
  border-color:#ffffff;
  color:#000000;
}
.zone-select-btn:hover .zone-icon{ opacity:1; }
.zone-select-btn .zone-icon{ font-size:28px; line-height:1; opacity:0.9; transition:.25s ease; }
.zone-select-btn .zone-info{ display:flex; flex-direction:column; gap:4px; }
.zone-select-btn .zone-info strong{ font-size:16px; color:inherit; transition:.25s ease; }
.zone-select-btn .zone-info small{ font-size:12px; color:#a0a0a0; transition:.25s ease; }
.zone-select-btn:hover .zone-info small{ color:#555555; }

/* ====== Responsive ====== */
@media (max-width: 880px){
  .sb{
    position:fixed; left:-300px; top:0; bottom:0; z-index:10; transition:.25s ease;
  }
  body.sidebar-open .sb{ left:0; }
  body.sidebar-open .overlay{ opacity:1; pointer-events:auto; }
}
/* === HOTFIX DARK BACKGROUND === */
html, body {
  background: #000 !important;   /* nero pieno */
  color: #fff !important;
}

.main {
  background: #000 !important;   /* anche l'area centrale nera */
}

/* Pannelli leggermente pi첫 chiari per contrasto */
.chat-log,
.composer {
  background: #0f0f0f !important;
  border-color: #1f1f1f !important;
}

.sb { /* sidebar */
  background: #121212 !important;
  border-right: 1px solid #1f1f1f !important;
}
/* === DARK MODE FORZATA === */
html, body {
  background-color: #000 !important;
  color: #fff !important;
  margin: 0;
  height: 100%;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
}

.main {
  background-color: #000 !important;
}

.chat-log, .composer {
  background-color: #0f0f0f !important;
  border: 1px solid #1f1f1f !important;
}

.sb {
  background-color: #121212 !important;
  border-right: 1px solid #1f1f1f !important;
}
/* === Pulsante Reset === */
.reset-container {
  display: flex;
  justify-content: center;
  margin-top: 20px;
}
.reset-btn {
  background: #ff4040;
  color: #fff;
  font-weight: 700;
  border: none;
  border-radius: 10px;
  padding: 10px 20px;
  cursor: pointer;
  transition: 0.2s;
}
.reset-btn:hover {
  background: #ff0000;
}
/* === Blocco/Reset UX === */
.lock-banner{
  position: sticky;
  bottom: 12px;
  margin: 10px auto 0;
  background:#1a1a1a;
  border:1px solid #2a2a2a;
  border-radius:10px;
  padding:10px 12px;
  display:flex;
  align-items:center;
  gap:12px;
  max-width: 820px;
}
.lock-banner .note{ color:#ffc9c9; }
.lock-banner .reset-btn{
  margin-left:auto;
  background:#ff4040;
  color:#fff;
  font-weight:700;
  border:none;
  border-radius:10px;
  padding:8px 14px;
  cursor:pointer;
}
.lock-banner .reset-btn:hover{ background:#ff0000; }

.sb-btn:disabled,
.send:disabled{
  opacity:.45;
  cursor:not-allowed;
}
.composer textarea:disabled{
  opacity:.6;
  cursor:not-allowed;
}

/* === Tabella Spedizioni === */
.shipping-table-section {
  background: var(--panel);
  border: 1px solid var(--stroke);
  border-radius: 14px;
  padding: 20px;
  margin-top: 16px;
}

.shipping-table-section h2 {
  color: var(--text);
  font-size: 18px;
  margin: 0 0 16px 0;
  font-weight: 600;
}

.shipping-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 12px;
}

.shipping-table thead {
  background: #1a1a1a;
}

.shipping-table th {
  color: var(--accent);
  text-align: left;
  padding: 12px;
  font-weight: 700;
  font-size: 14px;
  border-bottom: 2px solid var(--stroke);
}

.shipping-table td {
  padding: 8px;
  border-bottom: 1px solid var(--stroke);
}

.shipping-table input[type="text"],
.shipping-table input[type="url"] {
  width: 100%;
  background: #0f0f0f;
  color: var(--text);
  border: 1px solid var(--stroke);
  border-radius: 6px;
  padding: 8px 10px;
  font-size: 14px;
  outline: none;
  transition: .2s;
}

.shipping-table input:focus {
  border-color: var(--accent);
  background: #1a1a1a;
}

.shipping-table .apri-link {
  background: var(--accent);
  color: #000000;
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  font-weight: 700;
  font-size: 13px;
  cursor: pointer;
  transition: .2s;
  white-space: nowrap;
}

.shipping-table .apri-link:hover {
  background: var(--accent-2);
}

.add-row-btn {
  background: #1a1a1a;
  color: var(--accent);
  border: 1px solid var(--stroke);
  border-radius: 8px;
  padding: 10px 16px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: .2s;
}

.add-row-btn:hover {
  background: var(--accent);
  color: #000000;
  border-color: var(--accent);
}

/* ====== Mobile Responsive Optimization ====== */

/* Hamburger menu button */
.hamburger-btn {
  display: none; /* Hidden by default on desktop */
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 15;
  background: #1a1a1a;
  border: 1px solid var(--stroke);
  border-radius: 8px;
  width: 48px;
  height: 48px;
  padding: 0;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 5px;
  cursor: pointer;
  transition: .25s ease;
}

.hamburger-btn span {
  display: block;
  width: 24px;
  height: 2px;
  background: var(--accent);
  border-radius: 2px;
  transition: .25s ease;
}

.hamburger-btn:hover {
  background: #2a2a2a;
  border-color: var(--accent);
}

/* Hamburger animation when sidebar is open */
body.sidebar-open .hamburger-btn span:nth-child(1) {
  transform: translateY(7px) rotate(45deg);
}

body.sidebar-open .hamburger-btn span:nth-child(2) {
  opacity: 0;
}

body.sidebar-open .hamburger-btn span:nth-child(3) {
  transform: translateY(-7px) rotate(-45deg);
}

/* Tablet (768px - 1024px) */
@media (max-width: 1024px) {
  .main {
    padding: 12px;
  }

  .chat-log {
    padding: 16px;
  }

  .composer {
    padding: 12px;
  }

  .composer textarea {
    font-size: 16px; /* Prevent iOS zoom */
  }

  .sb-btn {
    padding: 14px 16px;
  }

  .shipping-table-section {
    padding: 16px;
  }
}

/* Mobile (max 767px) */
@media (max-width: 767px) {
  body {
    font-size: 14px;
  }

  /* Show hamburger button on mobile */
  .hamburger-btn {
    display: flex;
  }

  .main {
    padding: 8px;
    margin-left: 0; /* Remove sidebar margin on mobile */
    padding-top: 72px; /* Space for hamburger button */
  }

  /* Sidebar ottimizzata per mobile */
  .sb {
    width: 280px;
    left: -280px;
  }

  .sb-header {
    padding: 16px;
  }

  .sb-header .logo {
    height: 40px;
  }

  .sb-header .brand {
    font-size: 18px;
  }

  /* Pulsanti sidebar pi첫 grandi per touch */
  .sb-btn {
    padding: 16px 20px;
    font-size: 16px;
    min-height: 56px; /* Touch-friendly size */
  }

  .sb-btn .btn-icon-img {
    width: 28px;
    height: 28px;
  }

  .sb-btn .btn-text {
    font-size: 16px;
  }

  /* Chat log ottimizzata */
  .chat-log {
    padding: 12px;
    max-width: 100%;
    border-radius: 10px;
  }

  .chat-bubble {
    max-width: 95%;
    padding: 12px 14px;
    font-size: 15px;
    border-radius: 16px;
  }

  .chat-bubble.user {
    margin-left: 5%;
  }

  .chat-bubble.assistant {
    margin-right: 5%;
  }

  /* Composer ottimizzato per mobile */
  .composer {
    padding: 10px;
    border-radius: 10px;
    flex-direction: column;
    gap: 8px;
  }

  .composer textarea {
    font-size: 16px; /* Prevent iOS auto-zoom */
    min-height: 48px;
    padding: 12px;
    border-radius: 10px;
  }

  .composer .send {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    min-height: 48px;
    border-radius: 10px;
  }

  /* Shipping table mobile */
  .shipping-table-section {
    padding: 12px;
    margin-top: 12px;
  }

  .shipping-table-section h2 {
    font-size: 16px;
    margin-bottom: 12px;
  }

  /* Zone selection */
  .zone-select-btn {
    padding: 16px;
    min-height: 70px;
  }

  .zone-select-btn .zone-icon {
    width: 40px;
    height: 40px;
  }

  .zone-select-btn .zone-info strong {
    font-size: 15px;
  }

  .zone-select-btn .zone-info small {
    font-size: 11px;
  }

  /* Lock banner mobile */
  .lock-banner {
    flex-direction: column;
    align-items: flex-start;
    padding: 12px;
    gap: 10px;
  }

  .lock-banner .reset-btn {
    width: 100%;
    text-align: center;
  }
}

/* Mobile piccolo (max 480px) */
@media (max-width: 480px) {
  .main {
    padding: 6px;
  }

  .chat-log {
    padding: 10px;
  }

  .chat-bubble {
    font-size: 14px;
    padding: 10px 12px;
  }

  .composer {
    padding: 8px;
  }

  .sb {
    width: 260px;
    left: -260px;
  }

  .sb-btn {
    padding: 14px 16px;
    font-size: 15px;
  }

  .shipping-table-section {
    padding: 10px;
  }

  .zone-select-btn {
    padding: 12px;
  }
}

/* Touch optimization for all mobile devices */
@media (hover: none) and (pointer: coarse) {
  /* Ensure all interactive elements are touch-friendly */
  button, .sb-btn, .send, .add-row-btn, .apri-link {
    min-height: 44px;
    min-width: 44px;
  }

  /* Prevent text selection on buttons */
  button, .sb-btn {
    -webkit-tap-highlight-color: rgba(255, 215, 0, 0.3);
    user-select: none;
  }

  /* Larger input areas for better touch experience */
  input, textarea {
    font-size: 16px !important; /* Prevent iOS zoom */
  }
}
